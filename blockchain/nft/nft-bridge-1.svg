<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="958px" preserveAspectRatio="none" style="width:1864px;height:958px;background:#00000000;" version="1.1" viewBox="0 0 1864 958" width="1864px" zoomAndPan="magnify"><defs><filter height="300%" id="fkk8stt87s9ie" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="96" x="891.5" y="949.8887">NFT Bridging</text><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="30" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="237" y="128.0049"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="30" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="237" y="228.6768"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="79.3359" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="636" y="193.3408"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="30" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="636" y="628.0322"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="65.3359" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="992" y="360.3506"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="65.3359" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="992" y="592.6963"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="109.3359" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="1401" y="395.6865"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="30" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="1800" y="461.0225"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="28" x2="28" y1="90.6689" y2="701.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="28" x2="28" y1="701.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="28" x2="28" y1="729.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="28" x2="28" y1="729.3682" y2="757.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="28" x2="28" y1="757.3682" y2="767.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="242" x2="242" y1="90.6689" y2="701.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="242" x2="242" y1="701.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="242" x2="242" y1="729.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="242" x2="242" y1="729.3682" y2="757.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="242" x2="242" y1="757.3682" y2="767.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="641" x2="641" y1="90.6689" y2="701.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="641" x2="641" y1="701.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="641" x2="641" y1="729.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="641" x2="641" y1="729.3682" y2="757.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="641" x2="641" y1="757.3682" y2="767.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="817" x2="817" y1="309.8457" y2="701.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="817" x2="817" y1="701.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="817" x2="817" y1="729.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="817" x2="817" y1="729.3682" y2="757.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="817" x2="817" y1="757.3682" y2="767.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="997" x2="997" y1="90.6689" y2="701.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="997" x2="997" y1="701.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="997" x2="997" y1="729.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="997" x2="997" y1="729.3682" y2="757.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="997" x2="997" y1="757.3682" y2="767.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1177" x2="1177" y1="542.1914" y2="701.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1177" x2="1177" y1="701.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1177" x2="1177" y1="729.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1177" x2="1177" y1="729.3682" y2="757.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1177" x2="1177" y1="757.3682" y2="767.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1406" x2="1406" y1="90.6689" y2="701.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1406" x2="1406" y1="701.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1406" x2="1406" y1="729.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1406" x2="1406" y1="729.3682" y2="757.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1406" x2="1406" y1="757.3682" y2="767.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1805" x2="1805" y1="90.6689" y2="701.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1805" x2="1805" y1="701.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1805" x2="1805" y1="729.3682" y2="729.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1805" x2="1805" y1="729.3682" y2="757.3682"/><line style="stroke:#2F4F4F;stroke-width:1.0;" x1="1805" x2="1805" y1="757.3682" y2="767.3682"/><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="40" x="5" y="87.1689">Owner</text><ellipse cx="28" cy="15" fill="#F8F8FF" filter="url(#fkk8stt87s9ie)" rx="8" ry="8" style="stroke:#2F4F4F;stroke-width:2.0;"/><path d="M28,23 L28,50 M15,31 L41,31 M28,50 L15,65 M28,50 L41,65 " fill="none" filter="url(#fkk8stt87s9ie)" style="stroke:#2F4F4F;stroke-width:2.0;"/><rect fill="#F8F8FF" filter="url(#fkk8stt87s9ie)" height="51.3379" style="stroke:#2F4F4F;stroke-width:1.5;" width="94" x="193" y="34.3311"/><text fill="#000000" font-family="Monaco" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="80" x="200" y="56.5">«contract»</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="64" x="208" y="75.1689">n1:NFT A</text><rect fill="#F8F8FF" filter="url(#fkk8stt87s9ie)" height="51.3379" style="stroke:#2F4F4F;stroke-width:1.5;" width="102" x="588" y="34.3311"/><text fill="#000000" font-family="Monaco" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="80" x="599" y="56.5">«contract»</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="88" x="595" y="75.1689">b1:Bridge A</text><rect fill="#F8F8FF" filter="url(#fkk8stt87s9ie)" height="51.3379" style="stroke:#2F4F4F;stroke-width:1.5;" width="110" x="940" y="34.3311"/><text fill="#000000" font-family="Monaco" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="88" x="951" y="56.5">«off-chain»</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="96" x="947" y="75.1689">:Controlloer</text><rect fill="#F8F8FF" filter="url(#fkk8stt87s9ie)" height="51.3379" style="stroke:#2F4F4F;stroke-width:1.5;" width="102" x="1353" y="34.3311"/><text fill="#000000" font-family="Monaco" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="80" x="1364" y="56.5">«contract»</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="88" x="1360" y="75.1689">b2:Bridge B</text><rect fill="#F8F8FF" filter="url(#fkk8stt87s9ie)" height="51.3379" style="stroke:#2F4F4F;stroke-width:1.5;" width="94" x="1756" y="34.3311"/><text fill="#000000" font-family="Monaco" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="80" x="1763" y="56.5">«contract»</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="64" x="1771" y="75.1689">n2:NFT B</text><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="30" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="237" y="128.0049"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="30" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="237" y="228.6768"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="79.3359" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="636" y="193.3408"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="30" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="636" y="628.0322"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="65.3359" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="992" y="360.3506"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="65.3359" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="992" y="592.6963"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="109.3359" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="1401" y="395.6865"/><rect fill="#FFFFFF" filter="url(#fkk8stt87s9ie)" height="30" style="stroke:#2F4F4F;stroke-width:1.0;" width="10" x="1800" y="461.0225"/><polygon fill="#2F4F4F" points="225,124.0049,235,128.0049,225,132.0049,229,128.0049" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="28" x2="231" y1="128.0049" y2="128.0049"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="190" x="30" y="122.0049">approve(b1.addr, m)</text><polygon fill="#2F4F4F" points="624,189.3408,634,193.3408,624,197.3408,628,193.3408" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="28" x2="630" y1="193.3408" y2="193.3408"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="380" x="239" y="187.3408">requestExport(m, n2.addr, owner.addr2)</text><polygon fill="#2F4F4F" points="258,224.6768,248,228.6768,258,232.6768,254,228.6768" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="252" x2="635" y1="228.6768" y2="228.6768"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="370" x="259" y="222.6768">transferFrom(owner.addr1, b1.addr, m)</text><polygon fill="#2F4F4F" points="732,268.6768,742,272.6768,732,276.6768,736,272.6768" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="641" x2="738" y1="272.6768" y2="272.6768"/><rect fill="#F8F8FF" filter="url(#fkk8stt87s9ie)" height="51.3379" style="stroke:#2F4F4F;stroke-width:1.5;" width="142" x="744" y="266.6768"/><text fill="#000000" font-family="Monaco" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="56" x="787" y="288.8457">«event»</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="128" x="751" y="307.5146">:ExportRequested</text><polygon fill="#2F4F4F" points="828,356.3506,818,360.3506,828,364.3506,824,360.3506" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="822" x2="991" y1="360.3506" y2="360.3506"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="110" x="875" y="354.3506">&lt;&lt;consume&gt;&gt;</text><polygon fill="#2F4F4F" points="1389,391.6865,1399,395.6865,1389,399.6865,1393,395.6865" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="1002" x2="1395" y1="395.6865" y2="395.6865"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="380" x="1004" y="389.6865">requestImport(n2.addr, m, owner.addr2)</text><polygon fill="#2F4F4F" points="1788,457.0225,1798,461.0225,1788,465.0225,1792,461.0225" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="1411" x2="1794" y1="461.0225" y2="461.0225"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="370" x="1413" y="455.0225">transferFrom(b2.addr, owner.addr2, m)</text><polygon fill="#2F4F4F" points="1261,501.0225,1251,505.0225,1261,509.0225,1257,505.0225" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="1255" x2="1405" y1="505.0225" y2="505.0225"/><rect fill="#F8F8FF" filter="url(#fkk8stt87s9ie)" height="51.3379" style="stroke:#2F4F4F;stroke-width:1.5;" width="142" x="1104" y="499.0225"/><text fill="#000000" font-family="Monaco" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="56" x="1147" y="521.1914">«event»</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="128" x="1111" y="539.8604">:ImportCompleted</text><polygon fill="#2F4F4F" points="1165,588.6963,1175,592.6963,1165,596.6963,1169,592.6963" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="1002" x2="1171" y1="592.6963" y2="592.6963"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="110" x="1050" y="586.6963">&lt;&lt;consume&gt;&gt;</text><polygon fill="#2F4F4F" points="657,624.0322,647,628.0322,657,632.0322,653,628.0322" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="651" x2="991" y1="628.0322" y2="628.0322"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="140" x="845" y="622.0322">completeExport</text><polygon fill="#2F4F4F" points="1793,689.3682,1803,693.3682,1793,697.3682,1797,693.3682" style="stroke:#2F4F4F;stroke-width:1.0;"/><line style="stroke:#2F4F4F;stroke-width:1.3;" x1="28" x2="1799" y1="693.3682" y2="693.3682"/><text fill="#000000" font-family="Monaco" font-size="16" lengthAdjust="spacing" textLength="100" x="1688" y="687.3682">ownerOf(m)</text><rect fill="#DDDDDD" height="159.3516" rx="5" ry="5" style="stroke:#000000;stroke-width:1.0;" width="356" x="761" y="766.3682"/><ellipse cx="772.5" cy="782.5371" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="304" x="775" y="786.5371">token[mirrored].ownr = bridge-contract</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="0" x="775" y="805.2061"/><ellipse cx="772.5" cy="819.875" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="336" x="775" y="823.875">owner.addr1 : owner's address at network 1</text><ellipse cx="772.5" cy="838.5439" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="336" x="775" y="842.5439">owner.addr2 : owner'2 address at network 2</text><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="0" x="775" y="861.2129"/><ellipse cx="772.5" cy="875.8818" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="168" x="775" y="879.8818">timer based roll-back</text><ellipse cx="772.5" cy="894.5508" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="120" x="775" y="898.5508">status checking</text><ellipse cx="772.5" cy="913.2197" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="Monaco" font-size="14" lengthAdjust="spacing" textLength="184" x="775" y="917.2197">optimistic verification</text><!--MD5=[2671d62690537d8d28f4ffea5e0a2cd6]
@startuml

' https://plantuml.com/class-diagram
' https://plantuml.com/sequence-diagram
' https://plantuml-documentation.readthedocs.io/en/latest/formatting/all-skin-params.html
' https://plantuml-documentation.readthedocs.io/en/latest/formatting/all-skin-params.html#class
' https://plantuml.com/creole
' https://www.w3schools.com/colors/colors_names.asp

skinparam {
  'DefaultFontName Consolas
  DefaultFontName Monaco
  'DefaultFontName Lucida Console
  'DefaultMonospacedFontName Consolas
  'DefaultFontStyle bold
  
  BackgroundColor transparent
  PageMargin 10
  BoxPadding 100
  ParticipantPadding 20

  ArrowFontSize 16
  ArrowThickness 1
  MinClassWidth 75
  ClassFontStyle bold
  
  NoteBackgroundColor SeaShell
  NoteBorderColor transparent
  NoteShadowing false
}

skinparam Sequence{
  DividerBorderThickness 1.5
  ReferenceBorderThickness 1.5
  MessageAlignment right

  ArrowColor DarkSlateGray
  ArrowThickness 1.3
  LifeLineBorderColor DarkSlateGray
  LifeLineBorderThickness 1.3

  ActorBorderColor DarkSlateGray
  ActorBackgroundColor GhostWhite
  ParticipantBorderColor DarkSlateGray
  ParticipantBorderThickness 1.5
  ParticipantBackgroundColor GhostWhite

  BoxBackgroundColor transparent
  BoxBorderColor transparent
  
  GroupBorderThickness 1.3
  GroupBorderColor DarkBlue
  GroupBodyBackgroundColor Azure
}

skinparam Group{
  BorderThickness 1.3
  BorderShadowing true
}

hide Circle
hide Footbox
caption NFT Bridging


Actor Owner as owner
Participant "n1:NFT A" as nft1 <<contract>>
Participant "b1:Bridge A" as brd1 <<contract>>
Participant ":ExportRequested" as ev1 <<event>>
Participant ":Controlloer" as cntrl <<off-chain>>
Participant ":ImportCompleted" as ev2 <<event>>
Participant "b2:Bridge B" as brd2 <<contract>>
Participant "n2:NFT B" as nft2 <<contract>>


owner -> nft1 ++ : approve(b1.addr, m)
nft1 - -

owner -> brd1 ++ : requestExport(m, n2.addr, owner.addr2)
  brd1 -> nft1 ++ : transferFrom(owner.addr1, b1.addr, m)
    nft1 - -
  brd1 -> ev1 **
  brd1 - -
  cntrl -> ev1 : <<consume>>
    cntrl ++
    cntrl -> brd2 ++ : requestImport(n2.addr, m, owner.addr2)
      cntrl - -
      brd2 -> nft2 ++ : transferFrom(b2.addr, owner.addr2, m)
        nft2 - -
      brd2 -> ev2 **
      brd2 - -
      cntrl -> ev2 : <<consume>>
        cntrl ++ 
        cntrl -> brd1 ++ : completeExport
          brd1 - -
        cntrl - -

owner -> nft2 : ownerOf(m)

...
...

legend
  * token[mirrored].ownr = bridge-contract

  * owner.addr1 : owner's address at network 1
  * owner.addr2 : owner'2 address at network 2
  
  * timer based roll-back
  * status checking
  * optimistic verification
end legend


@enduml

@startuml


skinparam {
  DefaultFontName Monaco
  
  BackgroundColor transparent
  PageMargin 10
  BoxPadding 100
  ParticipantPadding 20

  ArrowFontSize 16
  ArrowThickness 1
  MinClassWidth 75
  ClassFontStyle bold
  
  NoteBackgroundColor SeaShell
  NoteBorderColor transparent
  NoteShadowing false
}

skinparam Sequence{
  DividerBorderThickness 1.5
  ReferenceBorderThickness 1.5
  MessageAlignment right

  ArrowColor DarkSlateGray
  ArrowThickness 1.3
  LifeLineBorderColor DarkSlateGray
  LifeLineBorderThickness 1.3

  ActorBorderColor DarkSlateGray
  ActorBackgroundColor GhostWhite
  ParticipantBorderColor DarkSlateGray
  ParticipantBorderThickness 1.5
  ParticipantBackgroundColor GhostWhite

  BoxBackgroundColor transparent
  BoxBorderColor transparent
  
  GroupBorderThickness 1.3
  GroupBorderColor DarkBlue
  GroupBodyBackgroundColor Azure
}

skinparam Group{
  BorderThickness 1.3
  BorderShadowing true
}

hide Circle
hide Footbox
caption NFT Bridging


Actor Owner as owner
Participant "n1:NFT A" as nft1 <<contract>>
Participant "b1:Bridge A" as brd1 <<contract>>
Participant ":ExportRequested" as ev1 <<event>>
Participant ":Controlloer" as cntrl <<off-chain>>
Participant ":ImportCompleted" as ev2 <<event>>
Participant "b2:Bridge B" as brd2 <<contract>>
Participant "n2:NFT B" as nft2 <<contract>>


owner -> nft1 ++ : approve(b1.addr, m)
nft1 - -

owner -> brd1 ++ : requestExport(m, n2.addr, owner.addr2)
  brd1 -> nft1 ++ : transferFrom(owner.addr1, b1.addr, m)
    nft1 - -
  brd1 -> ev1 **
  brd1 - -
  cntrl -> ev1 : <<consume>>
    cntrl ++
    cntrl -> brd2 ++ : requestImport(n2.addr, m, owner.addr2)
      cntrl - -
      brd2 -> nft2 ++ : transferFrom(b2.addr, owner.addr2, m)
        nft2 - -
      brd2 -> ev2 **
      brd2 - -
      cntrl -> ev2 : <<consume>>
        cntrl ++ 
        cntrl -> brd1 ++ : completeExport
          brd1 - -
        cntrl - -

owner -> nft2 : ownerOf(m)

...
...

legend
  * token[mirrored].ownr = bridge-contract

  * owner.addr1 : owner's address at network 1
  * owner.addr2 : owner'2 address at network 2
  
  * timer based roll-back
  * status checking
  * optimistic verification
end legend


@enduml

PlantUML version 1.2021.5(Sun Apr 25 20:20:28 KST 2021)
(EPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: ko
Country: KR
--></g></svg>